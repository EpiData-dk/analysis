<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta name="copyright" content="EpiData Association" />
    <meta name="author" content="Jens Lauritsen" />

    <title>EpiData Analysis - How to solutions.</title>
    <style type="text/css">
	<!--
      P {
        color : #000000;
        font-family : serif, sanserif, monospace;
        font-size : 1.0em;
        ALIGN =JUSTIFY}
      H1 {
        font-size : 1.1em;
        margin-top : 1cm;
        color : #000000;
        widows : 2;
        orphans : 2;
        color : Blue
      }
      H2 {
        font-size : 1.05em;
        margin-top : 0.5cm;
        direction : ltr;
        color : #000000;
        text-align : left;
        ;
        color : Blue
      }
      H3 {
        font-size : 1.025em;
        margin-top : 0.5cm;
        direction : ltr;
        color : #000000;
        text-align : left;
        ;
        color : Blue
      }
      H4 {
        font-size : 1.0em;
        margin-top : 0.5cm;
        direction : ltr;
        color : #000000;
        text-align : left;
        ;
        color : Blue
      }
      .heading {
        color : blue;
        font-weight : bold;
        font-size : 1.05em;
        ALIGN =JUSTIFY}
      .cmdgroup {
        color : blue;
        font-weight : normal;
        background-color : yellow
      }
      .bodywhite {
        color : black;
        background-color : white;
      }
      .body {
        color : white;
        background-color : white;
        font-size : 1.0em;
        font-weight : normal
      }
      .cmd {
        font-family : monospace;
        color : green;
        font-weight : normal;
      }
      .cmdcomment {
        font-style: italic;
        color: blue;
      }
      .cmdgroup {
        color : blue;
        font-weight : normal;
        background-color : yellow
      }
      .limit {
        font-weight : bold;
        color : red;
      }
      .indent {
        margin-left : 30px;
      }
      
      table {
        empty-cells : show;
        vertical-align : baseline;
        border-spacing : 0;
        font-family : serif, sanserif, monospace;
        font-size : 1.0em;
      }
      table {
        color : #000000;
        background-color : white;
        empty-cells : show;
      }
      table tr,
      td {
        border : solid blue 1px;
        background-color : white;
        Text-align : left;
        padding-left : .3em;
        padding-right : .3em;
        font-size : 1.0em
      }
      table .firstcol {
        Text-align : left;
        font-weight : bold;
        color : red
      }-->
	</style>
  </head>
  <body class="bodywhite">
    <a name="top">&nbsp;</a>
    <font face="Verdana" size="-1">
      <a href="commands.htm">Overview of commands</a>&nbsp;&nbsp;&nbsp; <a href="scguide.htm">Keyboard ShortCuts</a>&nbsp;&nbsp;&nbsp;</font>
    <h3>How to ..<font size="-1"> with EpiData Analysis</font>. <font size="-2">Document version Dec 2016.</font></h3> Hints and solutions on how to accomplish various tasks. - suggest additions <a href="mailto:epidata-list@lists.umanitoba.ca">on the EpiData list</a> or <a href="mailto:info@epidata.dk">e-mail info@epidata.dk</a>
    <table cellpadding="4" cellspacing="0">
      <tr>
        <td colspan="3">Groups available:</td>
      </tr>
      <tr>
        <td>
          <ul>
            <li><a href="#read">Start, Folders and files</a></li>
            <li><a href="#analysis">Basic analysis</a></li>
            <li><a href="#graph">Basic graphs</a></li>
            <li><a href="#save">Save &amp; clear output</a></li>
          </ul>
        </td>
        <td>
          <ul>
            <li><a href="#view">View data</a></li>
            <li><a href="#gen">Generate/Change variables</a></li>
            <li><a href="#dates">Working with dates and date variables</a></li>
            <li><a href="#stop">Clean up &amp; stop</a></li>
            <li><a href="#info">Information</a></li>
          </ul>
        </td>
        <td>
          <ul>
            <li><a href="#moreanalysis">Further analysis</a></li>
            <li><a href="#moregraph">Special graphs</a></li>
            <li><a href="#data">Special data handling</a></li>
            <li><a href="#disk">Disk commands</a></li>
          </ul>
        </td>
      </tr>
    </table>
    <hr />
    <table border="1" cellspacing="0" cellpadding="4" frame="void" rules="rows">

      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="read"></a><a href="#top">Top</a> Read &amp; Start - Folders and Files</td>
      </tr>

      <tr valign="top">
        <td>Control set parameters</td>
        <td><font class="cmd">Set &lt; parameter &gt; </font><br />
          <p>Set parameters control how much information you get in the output window (e.g. set statistics), how commands are executed (e.g. set replacedatafile) and other aspects</p>
          <font class="cmd">Set</font> just issue "set" with no words after to see which ones are defined. </td>
      </tr>

      <tr valign="top">
        <td>Folder changes</td>
        <td><font class="cmd">cd "name/folder"</font>
          <p>To make a particular folder the working folder either use a "cd ......." command in the epidatastat.ini file or define this in the lnk where you start epidata analysis.</p>
          <!--<font class="cmd">cd "name/folder"</font> during a run is not save to next run of the programme.-->
        </td>
      </tr>

      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="analysis"></a><a href="#top">Top</a> Basic analysis</td>
      </tr>
      <tr valign="top">
        <td>Select by date - existing variable</td>
        <td><font class="cmd">Select &lt;logical criteria&gt;</font>
          <p>
            Solution: use the built in formulae. Adapt according to your date format (dmy/mdy/ymd) <br />
            E.g. to select all born before 12th of february 1988 <br />
            <br />
            <font class="cmd">Select birthday &lt; createdate(12,2,1988)</font> using function createdate(day,month,year) <br />
            <font class="cmd">Select birthday &lt; createdate("02/12/1988", "mdy")</font> using createdate function with "mdy" <br />
            <font class="cmd">Select birthday &lt; createdate("12/02/1988", "dmy")</font> using createdate function with "dmy"
          </p>
        </td>
      </tr>

      <tr valign="top">
        <td>Select by date - create date variable</td>
        <td>Assume you have age in 1996 in field: age<br />
          <font class="cmd">
            new var date born;<br />
            new var int yearborn := 1996 - age;<br />
            born = createdate(1, 7, yearborn);<br />
            select born &lt; createdate(12, 2, 1988);  <font class="cmdcomment">//select all born before 12th of february 1988</font><br/>
            &nbsp;begin<br/>
            &nbsp;&nbsp; ...<br/>
            &nbsp;end<br/>
          </font> 
        </td>
      </tr>

      <!--<tr valign="top">
        <td>Exclude date from table</td>
        <td>Assume you have assigned Jan. 1st 1800 as the missing value in a date variable "born" <font class="cmd">freq born if born &lt;&gt; date("1,1,1800")</font>
        </td>
      </tr>-->

      <tr valign="top">
        <td>Test if a string variable contains legal dates</td>
        <td>You have read a text (delimited) file, and wish to convert a string variable to a date <br />Assumed variable names: The string variable with dates is "txtdate", ID is id number. <font class="cmd">
            <br />read myfile.csv <br />var </font>// to see the variables<br />* Now convert to date:<font class="cmd">
            <br />gen d mydate = date(txtdate) </font>// Incorrect date values will be "." <font class="cmd">
            <br />gen d mydate1 = date(txtdate,"V") </font>// Incorrect date values will be "01/01/1980" <font class="cmd">
            <br />gen i mydateok = (mydate = mydateok) </font>// 0 if they are the same, 1 if different<font class="cmd">
            <br />tables mydateok </font>// to see the count<font class="cmd">
            <br />select if mydateok = 1 <br />list id txtdate mydate mydate1</font>// to see the values<font class="cmd">
            <br />select <br />list id txtdate mydate mydate1 if mydateok = 1 </font>// alternative to select </td>
      </tr>

      <tr valign="top">
        <td>Check for missing data <br />in several variables</td>
        <td>Generate an indicator variable: m <font class="cmd">
            <br />define m _____________________________ <br />if v1 = . then m = trim(m) + "N" else mv = mv + "V" <br />if v2 = . then m = trim(m) + "N" else mv = mv + "V" <br />etc. for all other variables, <br />freq m <br />* alternative solution: <br />m = "" <br />m = trim(m)+string(mv(sex)) // function mv = 0 for actual value <br />m = trim(m)+string(mv(age)) // function mv = 1 if variable=. <br />m = trim(m)+string(mv(km)) // function mv = 2 if variable=defined missing value <br />tab m </font>
        </td>
      </tr>

      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="graph"></a><a href="#top">Top</a> Basic graphs</td>
      </tr>

      <tr valign="top">
        <td>Split Y variable</td>
        <td>Assume you wish to make a scatter plot of Haemoglobin Values by age where males are circles and females filled circles. <br /><font class="cmd">Scatter age Hb by sex</font> would be convenient, but You cannot do that since "by sex" is not allowed.<br /> Solution: Assume sex is 1 for males and 2 for females, Hb is Haemoglobin<br />
          <font class="cmd">
            <br />gen male = Hb if sex = 1 <br />gen female = Hb if sex = 2 <br />Scatter age male female /ti="My nice graph of variable Y by sex" /sub="With this subtitle"</font>
        </td>
      </tr>

      <tr valign="top">
        <td>Add text for Y-axis</td>
        <td>Solutions. E.g. for scatter plot to add "y=log(age)" <ul>
            <li>Add a textbox at top of Y-axis: <font class="cmd">scatter x-var y-var /text="15,50,Y=log(age),0"</font><br /> Experiment a little with the numbers 15 and 50 (pixels from top left) </li>
            <li>Use "/edit" and in "edit all" add title to left axis. With this you can change direction of text.</li>
            <li>Or use a combination of /text and /edit</li>
          </ul>Same for other graph types. </td>
      </tr>


      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="save"></a><a href="#top">Top</a> Output</td>
      </tr>

      <tr valign="top">
        <td>Change Output Colour and design</td>
        <td>Desing of output is controlled by a "stylesheet" contained in epiout.css which you can edit. <br />Several web sites and books explain more on how to use stylesheets. <br />To change background for tables to white: <br />&nbsp;&nbsp;&nbsp;1. Open the epiout.css file in the editor found where EpiData Analysis is installed <br />&nbsp;&nbsp;&nbsp;2. Change this line: <br />&nbsp;&nbsp;&nbsp;&nbsp;<font size="-1">table {background-color:black; border: solid #000 3px; width: 500px; } <br />&nbsp;&nbsp;&nbsp;<b>to</b>
            <br />&nbsp;&nbsp;&nbsp;&nbsp;table {background-color:white; border: solid #000 3px; width: 800px; } <br />&nbsp;&nbsp;&nbsp;</font>and for the cellcontents change color to black or other color or contents are invisible. E.g.: <br />&nbsp;&nbsp;&nbsp;&nbsp;<font size="-1"> .firstcol {color: black;font-size: 10pt;font-family: verdana; font-weight: normal; text-align: right; padding-right:10px; } </font>
          <br />&nbsp;&nbsp;&nbsp;3. Save the css file as Whitetable.css and use by <font class="cmd">set stylesheet="whitetable.css"</font>
          <br />Submit examples to info@epidata.dk for dissemination to other users. <br />See further explanation in document: <a href="epidata analysis output.htm">Formatting output</a>&nbsp;&nbsp;&nbsp; </td>
      </tr>


      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="gen"></a><a href="#top">Top</a> Generate/change variables</td>
      </tr>
      <tr valign="top">
        <td>Boolean Variables</td>
        <td><font class="cmd">define lonely &lt;Y&gt;</font>
          <br />This would define a Boolean variable. To add values use: <br />lonely = True <br />lonely = False </td>
      </tr>
      <tr>
        <td colspan="2" class="cmdgroup"><a name="stop"></a><a href="#top">Top</a> Clean up &amp; stop </td>
      </tr>

      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="dates"></a><a href="#top">Top</a> Dates and date variables</td>
      </tr>

      <tr valign="top">
        <td>What are dates</td>
        <td>In EpiData Analysis dates are used internally as the number of days since 1899/12/30 but shown in a known date format, such as <ul>
            <li>dmy: "01/01/2000" </li>
            <li>mdy: "12/25/2000"</li>
            <li>ymd: "2000/01/25"</li>
          </ul> Below you can find examples of how to handle date variables <font class="cmd">freq born if born &lt;&gt; date("1,1,1800")</font>
        </td>
      </tr>

      <tr valign="top">
        <td>Exclude date from table</td>
        <td>Assume you have assigned Jan. 1st 1800 as the missing value in a date variable "born"<br/>
          <font class="cmd">select born &lt;&gt; createdate(1,1,1800) freq born </font>
        </td>
      </tr>

      <tr valign="top">
        <td>Calculate age on day of visit</td>
        <td>Assume you have date of birth in variable DOB and date of visit in VISIT<br/>
          <font class="cmd">
            new var int agedays := visit - dob <font class="cmdcomment">// days</font><br/>
            new var int ageyear := integer(agedays / 365.25) <font class="cmdcomment">// years</font><br/>
          </font>
        </td>
      </tr>

      <tr valign="top">
        <td>Calculate age on day of visit - simulation example</td>
        <td>To see the example you can use this code: <font class="cmd">close generate 10 gen d dob = dmy(15,1,(1930+5*_n)) gen d visit = dmy(15,_n,2007) gen i age = trunc((visit-dob)/365.25) gen i age1 = round((visit-dob)/365.25) gen age2 = (visit-dob)/365.25 list</font>
          <br />Notice that by rounding you get incorrect age, whereas truncating gives the correct one. </td>
      </tr>

      <tr valign="top">
        <td>Select by date - create date variable</td>
        <td>Assume you have age in 1996 in field: age <font class="cmd">
            <br />define born &lt;dd/mm/yyyy&gt; <br />gen yearborn = 1996-age <br />born = dmy(1,7,yearborn) <br />Select born &lt; dmy(12,2,1988)</font> //select all born before 12th of february 1988 </td>
      </tr>


      <tr valign="top">
        <td>Test if a string variable contains legal dates</td>
        <td>You have read a text (delimited) file, and wish to convert a string variable to a date <br />Assumed variable names: The string variable with dates is "txtdate", ID is id number. <font class="cmd">
            <br />read myfile.csv <br />var </font>// to see the variables<br />* Now convert to date:<font class="cmd">
            <br />gen d mydate = date(txtdate) </font>// Incorrect date values will be "." <font class="cmd">
            <br />gen d mydate1 = date(txtdate,"V") </font>// Incorrect date values will be "01/01/1980" <font class="cmd">
            <br />gen i mydateok = (mydate = mydateok) </font>// 0 if they are the same, 1 if different<font class="cmd">
            <br />tables mydateok </font>// to see the count<font class="cmd">
            <br />select if mydateok = 1 <br />list id txtdate mydate mydate1</font>// to see the values<font class="cmd">
            <br />select <br />list id txtdate mydate mydate1 if mydateok = 1 </font>// alternative to select </td>
      </tr>


      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="info"></a><a href="#top">Top</a> Information</td>
      </tr>

      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="moreanalysis"></a><a href="#top">Top</a> Further analysis</td>
      </tr>
      <tr valign="top">
        <td>Regression</td>
        <td><font class="cmd">Logistic Outcome Indicator Confounder ......</font><br />
          <br />You cannot do Logistic Regression or other advanced statistics. Use other software. <br />Data can be exported with labels to Stata (www.stata.com), SAS, SPSS and as delimited files to other software. </td>
      </tr>



      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="moregraph"></a><a href="#top">Top</a> Special graphs </td>
      </tr>
      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="data"></a><a href="#top">Top</a> Special data handling </td>
      </tr>
      <!--.............................       group here .............................................        -->
      <tr>
        <td colspan="2" class="cmdgroup"><a name="disk"></a><a href="#top">Top</a> Disk commands </td>
      </tr>
    </table>
  </body>
</html>
